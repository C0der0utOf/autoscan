"""Tests for vulnerability scanning."""

import pytest

from src.vulnerability.cve_scanner import CVEScanner


def test_cve_scanner_initialization():
    """Test CVE scanner initialization."""
    scanner = CVEScanner()
    assert scanner.cache_dir is not None
    assert scanner.base_url is not None


def test_cve_severity_calculation():
    """Test CVSS score to severity mapping."""
    scanner = CVEScanner()

    # Test different CVSS scores
    test_cases = [
        (9.5, "critical"),
        (7.5, "high"),
        (5.0, "medium"),
        (2.0, "low"),
        (None, "info"),
    ]

    for cvss_score, expected_severity in test_cases:
        cve_data = {"id": "CVE-TEST", "cvss_score": cvss_score}
        severity = scanner._calculate_severity(cve_data)
        assert severity.value == expected_severity

