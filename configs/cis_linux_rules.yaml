rules:
  - id: "1.1.1.1"
    name: "Ensure mounting of cramfs filesystems is disabled"
    check: "check_module_disabled"
    params:
      module: "cramfs"
    severity: "medium"
    description: "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems"
    remediation: "Edit /etc/modprobe.d/blacklist.conf and add: blacklist cramfs"

  - id: "1.1.1.2"
    name: "Ensure mounting of squashfs filesystems is disabled"
    check: "check_module_disabled"
    params:
      module: "squashfs"
    severity: "low"
    description: "The squashfs filesystem type is a compressed read-only Linux filesystem"
    remediation: "Edit /etc/modprobe.d/blacklist.conf and add: blacklist squashfs"

  - id: "1.1.1.3"
    name: "Ensure mounting of udf filesystems is disabled"
    check: "check_module_disabled"
    params:
      module: "udf"
    severity: "low"
    description: "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346"
    remediation: "Edit /etc/modprobe.d/blacklist.conf and add: blacklist udf"

  - id: "1.1.2"
    name: "Ensure /tmp is configured"
    check: "check_tmp_mount"
    severity: "high"
    description: "The /tmp directory is a world-writable directory used for temporary file storage"
    remediation: "Configure /tmp as a separate filesystem or use systemd tmpfs"

  - id: "1.1.3"
    name: "Ensure nodev option set on /tmp partition"
    check: "check_mount_option"
    params:
      mount_point: "/tmp"
      option: "nodev"
    severity: "medium"
    description: "The nodev mount option specifies that the filesystem cannot contain special devices"
    remediation: "Edit /etc/fstab and add nodev to the /tmp mount options"

  - id: "1.1.4"
    name: "Ensure nosuid option set on /tmp partition"
    check: "check_mount_option"
    params:
      mount_point: "/tmp"
      option: "nosuid"
    severity: "medium"
    description: "The nosuid mount option specifies that the filesystem cannot contain setuid files"
    remediation: "Edit /etc/fstab and add nosuid to the /tmp mount options"

  - id: "1.1.5"
    name: "Ensure noexec option set on /tmp partition"
    check: "check_mount_option"
    params:
      mount_point: "/tmp"
      option: "noexec"
    severity: "medium"
    description: "The noexec mount option specifies that the filesystem cannot contain executable binaries"
    remediation: "Edit /etc/fstab and add noexec to the /tmp mount options"

  - id: "1.2.1"
    name: "Ensure package manager repositories are configured"
    check: "check_package_repos"
    severity: "high"
    description: "System package managers should be configured with valid repositories"
    remediation: "Configure your package manager with official repositories"

  - id: "1.2.2"
    name: "Ensure GPG keys are configured"
    check: "check_gpg_keys"
    severity: "high"
    description: "GPG keys should be configured for package verification"
    remediation: "Import and configure GPG keys for your package repositories"

  - id: "1.3.1"
    name: "Ensure AIDE is installed"
    check: "check_package_installed"
    params:
      package: "aide"
    severity: "medium"
    description: "AIDE (Advanced Intrusion Detection Environment) is a file and directory integrity checker"
    remediation: "Install AIDE using your package manager: apt-get install aide or yum install aide"

  - id: "1.3.2"
    name: "Ensure filesystem integrity is regularly checked"
    check: "check_aide_cron"
    severity: "medium"
    description: "AIDE should be configured to run regularly via cron"
    remediation: "Configure a cron job to run AIDE checks regularly"

